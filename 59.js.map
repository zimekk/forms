{"version":3,"file":"59.js","mappings":"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","sources":["webpack://@dev/web/./src/components/styles.module.scss?8b42","webpack://@dev/web/./src/components/index.tsx","webpack://@dev/web/./src/constants.ts","webpack://@dev/web/./src/containers/Forms.module.scss?8e89","webpack://@dev/web/./src/containers/Forms.tsx","webpack://@dev/web/./src/components/styles.module.scss","webpack://@dev/web/./src/containers/Forms.module.scss"],"sourcesContent":["\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { createContext, useContext, useMemo } from \"react\";\nimport cx from \"classnames\";\nimport styles from \"./styles.module.scss\";\n\nconst FormContext = createContext({});\n\nexport function Form({\n  data,\n  handleChange,\n  handleSubmit,\n  ...props\n}: {\n  children: any;\n}) {\n  return (\n    <FormContext.Provider value={{ ...data, handleChange }}>\n      <form\n        tabIndex={0}\n        onSubmit={handleSubmit}\n        {...props}\n        className={cx(styles.Form)}\n        // , data[Step.Step2].errors && styles.invalid\n      />\n    </FormContext.Provider>\n  );\n}\n\nexport function Fieldset({ ...props }) {\n  return <fieldset {...props} />;\n}\n\nexport function Legend({ ...props }) {\n  return <legend {...props} />;\n}\n\nconst FieldContext = createContext({});\n\nexport function Field({ name, ...props }: { children: any; name: string }) {\n  const { errors } = useContext(FormContext);\n\n  return (\n    <FieldContext.Provider\n      value={{\n        name,\n        errors: useMemo(\n          () => (errors || []).filter(({ path }) => path.join(\".\") === name),\n          [errors]\n        ),\n      }}\n    >\n      <div {...props} />\n    </FieldContext.Provider>\n  );\n}\n\nexport function Label({ ...props }) {\n  const { name } = useContext(FieldContext);\n  return (\n    <div>\n      <label htmlFor={name} {...props} />\n    </div>\n  );\n}\n\nexport function Input({ ...props }) {\n  const { name } = useContext(FieldContext);\n  const { form, handleChange } = useContext(FormContext);\n  return (\n    <div>\n      <input\n        name={name}\n        value={form[name]}\n        onChange={handleChange}\n        {...props}\n      />\n    </div>\n  );\n}\n\nexport function Errors({ ...props }) {\n  const { errors } = useContext(FieldContext);\n\n  return errors ? (\n    <ul className={styles.Errors}>\n      {errors.map(({ message }, key) => (\n        <li key={key}>{message}</li>\n      ))}\n    </ul>\n  ) : null;\n}\n\nexport function Button({ ...props }: { children: any; value: string }) {\n  const { busy } = useContext(FormContext);\n  return (\n    <div>\n      <button type=\"submit\" name=\"action\" disabled={busy} {...props} />\n    </div>\n  );\n}\n","export type Flow = {\n  uuid: string;\n};\n\nexport enum View {\n  Step1 = \"STEP_1\",\n  Step2 = \"STEP_2\",\n  Step3 = \"STEP_3\",\n}\n\nexport enum Action {\n  Init = \"INIT\",\n  Next = \"NEXT\",\n  Back = \"BACK\",\n  Logout = \"LOGOUT\",\n}\n\nexport const gql = (q) => q.join();\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Forms.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Forms.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useMutation } from \"graphql-hooks\";\nimport { Subject, from } from \"rxjs\";\nimport { debounceTime, delay, mergeMap, tap } from \"rxjs/operators\";\nimport {\n  Button,\n  Errors,\n  Field,\n  Fieldset,\n  Form,\n  Input,\n  Label,\n  Legend,\n} from \"../components\";\nimport { View, Action, gql } from \"../constants\";\nimport styles from \"./Forms.module.scss\";\n\nconst CHECK_USERNAME_QUERY = gql`\n  query CheckUsername($username: String) {\n    checkUsername(username: $username) {\n      valid\n    }\n  }\n`;\n\nconst SIGNIN_MUTATION = gql`\n  mutation Signin(\n    $flow: Flow\n    $action: Action\n    $step1: LoginStep1Input\n    $step2: LoginStep2Input\n  ) {\n    signin(flow: $flow, action: $action, step1: $step1, step2: $step2) {\n      __typename\n      flow\n      ... on Form {\n        view\n        errors {\n          code\n          message\n          path\n        }\n      }\n      ... on LoginStep1 {\n        username\n      }\n      ... on LoginStep2 {\n        password\n      }\n    }\n  }\n`;\n\nlet activeElement = null;\n\nfunction useForm(mutate, update, submit) {\n  const [data, setData] = useState(() => ({\n    form: {},\n    view: null,\n  }));\n\n  const mutate$ = useMemo(() => new Subject(), []);\n  useEffect(() => {\n    const subscription = mutate$\n      .pipe(\n        // tap(() => (activeElement = document.activeElement, console.log(activeElement))),\n        tap(() => setData((data) => ({ ...data, busy: true }))),\n        delay(500),\n        mergeMap((variables) => from(mutate({ variables }))),\n        delay(500),\n        tap(() => setData((data) => ({ ...data, busy: false })))\n      )\n      .subscribe(\n        (mutate) =>\n          Boolean(console.log({ mutate })) ||\n          setData(update(mutate.data)) ||\n          (document.contains(activeElement) && activeElement.focus())\n      );\n\n    mutate$.next({});\n\n    return () => subscription.unsubscribe();\n  }, [mutate$]);\n\n  const change$ = useMemo(() => new Subject(), []);\n  useEffect(() => {\n    const subscription = change$\n      // .pipe(\n      //   tap((a) => console.log([\"change\"], { a }))\n      // )\n      .subscribe(\n        (change) =>\n          Boolean(console.log({ change })) ||\n          //  setData(update(mutate.data))\n\n          setData((data) => ({\n            ...data,\n            form: {\n              ...data.form,\n              ...change,\n            },\n          }))\n      );\n    return () => subscription.unsubscribe();\n  }, [change$]);\n\n  const handleChange = useCallback(\n    (event) =>\n      (({\n        target: {\n          // form: { name },\n          name,\n          value,\n        },\n      }) =>\n        Boolean(console.log([\"handleChange\"], { name, value })) ||\n        change$.next({ [name]: value }))(event),\n    []\n  );\n\n  const handleSubmit = useCallback(\n    (event) =>\n      event.preventDefault() ||\n      console.log((activeElement = document.activeElement)) ||\n      (({\n        target,\n        // target: { name },\n        nativeEvent: {\n          submitter: { value: action },\n        },\n      }) =>\n        Boolean(console.log([\"handleSubmit\"], { action })) ||\n        target.focus() ||\n        mutate$.next(submit(action, data)))(event),\n    [data]\n  );\n\n  return [\n    data,\n    () => ({\n      key: data.view,\n      data,\n      handleChange,\n      handleSubmit,\n    }),\n    {\n      change$,\n      mutate$,\n    },\n  ];\n}\n\nexport default function Section() {\n  const [mutate] = useMutation(SIGNIN_MUTATION);\n  const [data, handleForm, { change$ }] = useForm(\n    mutate,\n    ({ signin: { flow, view, errors, ...form } }) =>\n      (data) =>\n        console.log({ data, flow, view, errors, form }) || {\n          ...data,\n          flow,\n          view,\n          errors,\n          form: { ...data.form, ...form },\n        },\n    (action, { flow, view, form }) =>\n      console.log({ action, flow, view, form }) ||\n      Object.assign(\n        { flow, action },\n        {\n          [View.Step1]: {\n            [Action.Next]: ({ username }) => ({\n              step1: { username },\n            }),\n          },\n          [View.Step2]: {\n            [Action.Back]: () => ({}),\n            [Action.Next]: ({ password }) => ({\n              step2: { password },\n            }),\n          },\n          [View.Step3]: {\n            [Action.Logout]: () => ({}),\n          },\n        }[view][action](form)\n      )\n  );\n\n  const [checkUsername] = useMutation(CHECK_USERNAME_QUERY);\n  const checkUsername$ = useMemo(() => new Subject(), []);\n  useEffect(() => {\n    const subscription = checkUsername$\n      .pipe(\n        delay(500),\n        mergeMap((variables) => from(checkUsername({ variables }))),\n        delay(500)\n      )\n      .subscribe(\n        (checkUsername$) =>\n          Boolean(console.log({ checkUsername$ })) ||\n          change$.next({\n            validUsername: checkUsername$.data.checkUsername.valid,\n          })\n        //  || setData(update(mutate.data))\n      );\n    return () => subscription.unsubscribe();\n  }, [checkUsername$]);\n\n  useEffect(() => {\n    const subscription = change$\n      .pipe(\n        debounceTime(500)\n        // tap((b) => console.log(['change'], {b}))\n      )\n      .subscribe(\n        (change) =>\n          Boolean(console.log({ change })) ||\n          (change.username &&\n            checkUsername$.next({\n              username: change.username,\n            }))\n      );\n    return () => subscription.unsubscribe();\n  }, [change$]);\n\n  console.log({ data });\n\n  return (\n    <section className={styles.Section}>\n      <h2>Forms</h2>\n      {data.view &&\n        {\n          [View.Step1]: () => (\n            <Form {...handleForm()}>\n              <Fieldset>\n                <Legend>Step1</Legend>\n                <Field name=\"username\">\n                  <Label>Username</Label>\n                  <Input autoFocus />\n                  {data.form.validUsername !== null && (\n                    <div>{data.form.validUsername ? \"Valid\" : \"Invalid\"}</div>\n                  )}\n                  <Errors />\n                </Field>\n                <Button value={Action.Next}>Next</Button>\n              </Fieldset>\n            </Form>\n          ),\n          [View.Step2]: () => (\n            <Form {...handleForm()}>\n              <Fieldset>\n                <Legend>Step2</Legend>\n                <Field name=\"password\">\n                  <Label>Password</Label>\n                  <Input autoFocus />\n                  <Errors />\n                </Field>\n                <Button value={Action.Next}>Next</Button>\n                <Button value={Action.Back}>Back</Button>\n              </Fieldset>\n            </Form>\n          ),\n          [View.Step3]: () => (\n            <Form {...handleForm()}>\n              <Fieldset>\n                <Legend>Step3</Legend>\n                <Button value={Action.Logout} autoFocus>\n                  Logout\n                </Button>\n              </Fieldset>\n            </Form>\n          ),\n        }[data.view](data.form)}\n    </section>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".Y0oU17ATPuJ3r9UC_xZg{color:blue}.g4QOpCIIrfx1xI7gat6G.FkcPsz_TwMovCk7Gel3Q fieldset{border-color:red}.DXGw6UCkT0Ljh5PLAFlR.FkcPsz_TwMovCk7Gel3Q{color:red}.O1DkzXeSlWwhWODvimtg{color:red}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,UAAA,CAIE,oDACE,gBAAA,CAKJ,2CACE,SAAA,CAGJ,sBACE,SAAA\",\"sourcesContent\":[\".Section {\\n  color: blue;\\n}\\n.Form {\\n  &.invalid {\\n    fieldset {\\n      border-color: red;\\n    }\\n  }\\n}\\n.Field {\\n  &.invalid {\\n    color: red;\\n  }\\n}\\n.Errors {\\n  color: red;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"Y0oU17ATPuJ3r9UC_xZg\",\n\t\"Form\": \"g4QOpCIIrfx1xI7gat6G\",\n\t\"invalid\": \"FkcPsz_TwMovCk7Gel3Q\",\n\t\"Field\": \"DXGw6UCkT0Ljh5PLAFlR\",\n\t\"Errors\": \"O1DkzXeSlWwhWODvimtg\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".HHGfdvALL8opRFX4T2Dp{color:blue}.zmbUS4qY6hyGuScChGns.yjjddBYwRSMIzHy7W6JZ fieldset{border-color:red}.mrN0PYufDWOQtcym4TuQ.yjjddBYwRSMIzHy7W6JZ{color:red}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Forms.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,UAAA,CAIE,oDACE,gBAAA,CAKJ,2CACE,SAAA\",\"sourcesContent\":[\".Section {\\n  color: blue;\\n}\\n.Form {\\n  &.invalid {\\n    fieldset {\\n      border-color: red;\\n    }\\n  }\\n}\\n.Field {\\n  &.invalid {\\n    color: red;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"HHGfdvALL8opRFX4T2Dp\",\n\t\"Form\": \"zmbUS4qY6hyGuScChGns\",\n\t\"invalid\": \"yjjddBYwRSMIzHy7W6JZ\",\n\t\"Field\": \"mrN0PYufDWOQtcym4TuQ\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","FormContext","createContext","Form","data","handleChange","handleSubmit","props","Provider","value","tabIndex","onSubmit","className","cx","styles","Fieldset","Legend","FieldContext","Field","name","errors","useContext","useMemo","filter","path","join","Label","htmlFor","Input","form","onChange","Errors","map","message","key","Button","busy","type","disabled","View","Action","gql","q","CHECK_USERNAME_QUERY","SIGNIN_MUTATION","activeElement","Section","mutate","useMutation","handleForm","change$","update","submit","setData","useState","view","mutate$","Subject","useEffect","subscription","pipe","tap","delay","mergeMap","variables","from","subscribe","Boolean","console","log","signin","flow","document","contains","focus","next","unsubscribe","change","useCallback","event","target","preventDefault","nativeEvent","submitter","action","Object","assign","Step1","Next","username","step1","Step2","Back","password","step2","Step3","Logout","useForm","checkUsername","checkUsername$","validUsername","valid","debounceTime","autoFocus","___CSS_LOADER_EXPORT___","push","module","id","locals"],"sourceRoot":""}