{"version":3,"file":"59.js","mappings":"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","sources":["webpack://@dev/web/./src/components/styles.module.scss?8b42","webpack://@dev/web/./src/components/index.tsx","webpack://@dev/web/./src/constants.ts","webpack://@dev/web/./src/containers/Forms.module.scss?8e89","webpack://@dev/web/./src/containers/Forms.tsx","webpack://@dev/web/./src/components/styles.module.scss","webpack://@dev/web/./src/containers/Forms.module.scss"],"sourcesContent":["\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { createContext, useContext } from \"react\";\nimport cx from \"classnames\";\nimport styles from \"./styles.module.scss\";\n\nconst FormContext = createContext({});\n\nexport function Form({ ...props }: { name: string }) {\n  return (\n    <FormContext.Provider value={{ name }}>\n      <form\n        {...props}\n        className={cx(styles.Form)}\n        // , data[Step.Step2].errors && styles.invalid\n      />\n    </FormContext.Provider>\n  );\n}\n\nexport function Fieldset({ ...props }) {\n  return <fieldset {...props} />;\n}\n\nexport function Legend({ ...props }) {\n  return <legend {...props} />;\n}\n\nconst FieldContext = createContext({});\n\nexport function Field({ name, ...props }: { name: string }) {\n  return (\n    <FieldContext.Provider value={{ name }}>\n      <div {...props} />\n    </FieldContext.Provider>\n  );\n}\n\nexport function Label({ ...props }) {\n  const { name } = useContext(FieldContext);\n  return (\n    <div>\n      <label htmlFor={name} {...props} />\n    </div>\n  );\n}\n\nexport function Input({ ...props }) {\n  const { name } = useContext(FieldContext);\n  return (\n    <div>\n      <input name={name} {...props} />\n    </div>\n  );\n}\n\nexport function Errors({ ...props }: { name: string }) {\n  return (\n    <div>\n      <span {...props} />\n    </div>\n  );\n}\n\nexport function Button({ ...props }: { value: string }) {\n  return (\n    <div>\n      <button type=\"submit\" name=\"action\" {...props} />\n    </div>\n  );\n}\n","export enum Step {\n  Step1 = \"STEP_1\",\n  Step2 = \"STEP_2\",\n  Step3 = \"STEP_3\",\n}\n\nexport enum Action {\n  Init = \"INIT\",\n  Next = \"NEXT\",\n  Back = \"BACK\",\n  Logout = \"LOGOUT\",\n}\n\nexport const gql = (q) => q.join();\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Forms.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Forms.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useMutation } from \"graphql-hooks\";\nimport { Subject, from } from \"rxjs\";\nimport { delay, mergeMap } from \"rxjs/operators\";\nimport {\n  Button,\n  Errors,\n  Field,\n  Fieldset,\n  Form,\n  Input,\n  Label,\n  Legend,\n} from \"../components\";\nimport { Step, Action, gql } from \"../constants\";\nimport styles from \"./Forms.module.scss\";\n\nconst SIGNIN_MUTATION = gql`\n  mutation Signin(\n    $step: String\n    $action: String\n    $step1: LoginStep1Input\n    $step2: LoginStep2Input\n  ) {\n    signin(step: $step, action: $action, step1: $step1, step2: $step2) {\n      __typename\n      step\n      ... on LoginStep1 {\n        username\n        errors {\n          username\n        }\n      }\n      ... on LoginStep2 {\n        password\n        errors {\n          password\n        }\n      }\n    }\n  }\n`;\n\nfunction useForm(mutate, update, submit) {\n  const [data, setData] = useState(() => ({}));\n\n  const mutate$ = useMemo(() => new Subject(), []);\n  useEffect(() => {\n    const subscription = mutate$\n      .pipe(\n        delay(500),\n        mergeMap((data) => from(mutate(data))),\n        delay(500)\n      )\n      .subscribe(\n        (mutate) =>\n          Boolean(console.log({ mutate })) || setData(update(mutate.data))\n      );\n\n    mutate$.next({});\n\n    return () => subscription.unsubscribe();\n  }, [mutate$]);\n\n  const handleChange = useCallback(\n    (event) =>\n      (({\n        target: {\n          form: { name: step },\n          name,\n          value,\n        },\n      }) =>\n        Boolean(console.log([\"handleChange\"], { step, name, value })) ||\n        setData((data) => ({\n          ...data,\n          [step]: {\n            ...data[step],\n            [name]: value,\n          },\n        })))(event),\n    []\n  );\n\n  const handleSubmit = useCallback(\n    (event) =>\n      event.preventDefault() ||\n      (({\n        target: { name: step },\n        nativeEvent: {\n          submitter: { value: action },\n        },\n      }) =>\n        Boolean(console.log([\"handleSubmit\"], { step, action })) ||\n        mutate$.next(submit(step, action, data)))(event),\n    [data]\n  );\n\n  return [data, handleChange, handleSubmit];\n}\n\nexport default function Section() {\n  const [mutate] = useMutation(SIGNIN_MUTATION);\n  const [data, handleChange, handleSubmit] = useForm(\n    mutate,\n    ({ signin }) =>\n      (data) => ({ ...data, [signin.step]: signin }),\n    (step, action, data) => ({\n      variables: Object.assign(\n        { step, action },\n        {\n          [Step.Step1]: {\n            [Action.Next]: ({ username }) => ({\n              step1: { username },\n            }),\n          },\n          [Step.Step2]: {\n            [Action.Back]: () => ({}),\n            [Action.Next]: ({ password }) => ({\n              step2: { password },\n            }),\n          },\n          [Step.Step3]: {\n            [Action.Logout]: () => ({}),\n          },\n        }[step][action](data[step])\n      ),\n    })\n  );\n\n  return (\n    <section className={styles.Section}>\n      <h2>Forms</h2>\n      {data[Step.Step1] && (\n        <Form\n          name={Step.Step1}\n          onChange={handleChange}\n          onSubmit={handleSubmit}\n          // data[Step.Step1].errors && styles.invalid\n        >\n          <Fieldset>\n            <Legend>Step1</Legend>\n            <Field name=\"username\">\n              <Label>Username</Label>\n              <Input autoFocus />\n            </Field>\n            <Errors />\n            <Button value={Action.Next}>Next</Button>\n          </Fieldset>\n        </Form>\n      )}\n      {data[Step.Step2] && (\n        <Form name={Step.Step2} onChange={handleChange} onSubmit={handleSubmit}>\n          <Fieldset>\n            <Legend>Step2</Legend>\n            <Field name=\"password\">\n              <Label>Password</Label>\n              <Input autoFocus />\n            </Field>\n            <Errors />\n            <Button value={Action.Next}>Next</Button>\n            <Button value={Action.Back}>Back</Button>\n          </Fieldset>\n        </Form>\n      )}\n      {data[Step.Step3] && (\n        <Form\n          name={Step.Step3}\n          onChange={handleChange}\n          onSubmit={handleSubmit}\n          // data[Step.Step3].errors && styles.invalid)}\n        >\n          <Fieldset>\n            <Legend>Step3</Legend>\n            <Field name=\"password\">\n              <Label>LoggedIn</Label>\n            </Field>\n            <Errors />\n            <Button value={Action.Logout} autoFocus>\n              Logout\n            </Button>\n          </Fieldset>\n        </Form>\n      )}\n    </section>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".Y0oU17ATPuJ3r9UC_xZg{color:blue}.g4QOpCIIrfx1xI7gat6G.FkcPsz_TwMovCk7Gel3Q fieldset{border-color:red}.DXGw6UCkT0Ljh5PLAFlR.FkcPsz_TwMovCk7Gel3Q{color:red}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,UAAA,CAIE,oDACE,gBAAA,CAKJ,2CACE,SAAA\",\"sourcesContent\":[\".Section {\\n  color: blue;\\n}\\n.Form {\\n  &.invalid {\\n    fieldset {\\n      border-color: red;\\n    }\\n  }\\n}\\n.Field {\\n  &.invalid {\\n    color: red;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"Y0oU17ATPuJ3r9UC_xZg\",\n\t\"Form\": \"g4QOpCIIrfx1xI7gat6G\",\n\t\"invalid\": \"FkcPsz_TwMovCk7Gel3Q\",\n\t\"Field\": \"DXGw6UCkT0Ljh5PLAFlR\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".HHGfdvALL8opRFX4T2Dp{color:blue}.zmbUS4qY6hyGuScChGns.yjjddBYwRSMIzHy7W6JZ fieldset{border-color:red}.mrN0PYufDWOQtcym4TuQ.yjjddBYwRSMIzHy7W6JZ{color:red}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Forms.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,UAAA,CAIE,oDACE,gBAAA,CAKJ,2CACE,SAAA\",\"sourcesContent\":[\".Section {\\n  color: blue;\\n}\\n.Form {\\n  &.invalid {\\n    fieldset {\\n      border-color: red;\\n    }\\n  }\\n}\\n.Field {\\n  &.invalid {\\n    color: red;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"HHGfdvALL8opRFX4T2Dp\",\n\t\"Form\": \"zmbUS4qY6hyGuScChGns\",\n\t\"invalid\": \"yjjddBYwRSMIzHy7W6JZ\",\n\t\"Field\": \"mrN0PYufDWOQtcym4TuQ\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","FormContext","createContext","Form","props","Provider","value","name","className","cx","styles","Fieldset","Legend","FieldContext","Field","Label","useContext","htmlFor","Input","Errors","Button","type","Step","Action","SIGNIN_MUTATION","q","join","Section","mutate","useMutation","data","handleChange","handleSubmit","update","submit","setData","useState","mutate$","useMemo","Subject","useEffect","subscription","pipe","delay","mergeMap","from","subscribe","Boolean","console","log","signin","step","next","unsubscribe","useCallback","event","target","form","preventDefault","nativeEvent","submitter","action","variables","Object","assign","Step1","Next","username","step1","Step2","Back","password","step2","Step3","Logout","useForm","onChange","onSubmit","autoFocus","___CSS_LOADER_EXPORT___","push","module","id","locals"],"sourceRoot":""}